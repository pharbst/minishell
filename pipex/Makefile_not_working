# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: pharbst <pharbst@student.42heilbronn.de    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/05/06 09:33:42 by peter             #+#    #+#              #
#    Updated: 2023/02/02 04:08:51 by pharbst          ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

SHELL=	/bin/bash

Black			=	$(shell echo -e "\033[0;30m")
FBlack			=	$(shell echo -e "\033[1;30m")
Red				=	$(shell echo -e "\033[0;31m")
FRed			=	$(shell echo -e "\033[1;31m")
Green			=	$(shell echo -e "\033[0;32m")
FGreen			=	$(shell echo -e "\033[1;32m")
Brown/Orange	=	$(shell echo -e "\033[0;33m")
FBrown/Orange	=	$(shell echo -e "\033[1;33m")
FYellow			=	$(shell echo -e "\033[1;33m")
Yellow			=	$(shell echo -e "\033[0;33m")
Blue			=	$(shell echo -e "\033[0;34m")
FBlue			=	$(shell echo -e "\033[1;34m")
Purple			=	$(shell echo -e "\033[0;35m")
FPurple			=	$(shell echo -e "\033[1;35m")
Cyan			=	$(shell echo -e "\033[0;36m")
FCyan			=	$(shell echo -e "\033[1;36m")
FWhite			=	$(shell echo -e "\033[1;37m")
White			=	$(shell echo -e "\033[0;37m")
RESET			=	$(shell echo -e "\033[0m")
TICK			=	$(shell echo -e "\xE2\x9C\x94")

PRONAME	=	Pipex
NAME	=	pipex
CC		=	cc
CFLAGS	=	-Wall -Wextra -Werror
CFLAGS	+=	-g
# CFLAGS	+=	-fsanatize=address

# directories
INC_DIR		=	includes
SRC_DIR		=	src/
OBJ_DIR		=	./obj/
LIBFT_DIR	=	../libft/

# librarys
LIBFTIO		=	$(LIBFT_DIR)libftio.a

# Include
INC_SRC		=	-I includes
INC_LIBFTIO	=	-I $(LIBFT_DIR)includes

FILES	=	pipex.c \
			set_pipe.c \


OBJS	=	$(addprefix $(OBJDIR)/, $(FILES:.c=.o))

all:
	@./spinner.sh make $(NAME)

$(NAME):	header libftio_header $(LIBFTIO) obj_header $(OBJS) linking_header
	@$(CC) $(CFLAGS) $(OBJS) $(INC_SRC) $(INC_LIBFTIO) -L $(LIBFT_DIR) -lftio -o $(NAME)
	@printf "$(FGreen)[$(TICK)]\n$(RESET)"

$(OBJDIR)/%.o:	$(SRCDIR)/*/%.c
	@mkdir -p $(OBJDIR)
	@$(CC) $(CFLAGS) -o $@ -c $(INC_LIBFTIO) $^ $(INC_SRC)

$(LIBFTIO):
	@make -C $(LIBFT_DIR) > /dev/null
	echo done
	@printf "$(FGreen)[$(TICK)]\n$(RESET)"

clean: header
	@printf "$(FRed)Clean $(PRONAME)$(FGreen)				   "
	@rm -rf $(OBJS)
	@rm -rf $(OBJDIR)
	@printf "$(FGreen)[$(TICK)]\n$(RESET)"

fclean: header
	@./spinner.sh make -s cleanall

cleanall:
	@printf "$(FRed)FCleaning $(PRONAME)$(FGreen)$(RESET)				   "
	@rm -rf $(OBJDIR)
	@rm -rf $(NAME)
	@printf "$(FGreen)[$(TICK)]\n$(RESET)"

re:
	@./spinner.sh make -s header cleanall $(NAME)

header:
	@printf "$(FYellow)╔════════════════════════════════════════════╗\n\
║   .-.   .-..----. .----..---. .-. .----.   ║\n\
║   | |   | || {}  }| {_ {_   _}| |/  {}  \\  ║\n\
║   | \`--.| || {}  }| |    | |  | |\\      /  ║\n\
║   \`----'\`-'\`----' \`-'    \`-'  \`-' \`----'   ║\n\
╚════════════════════════════════════════════╝\n"

libftio_header:
	@printf "$(FBlue)Compiling Libftio						      "

obj_header:
	@printf "$(FBlue)Compiling .o files$(RESET)			   "

linking_header:
	@printf "$(FGreen)[$(TICK)]\n$(Green)Linking $(PRONAME)$(RESET)				   "

git:	commit push

commit:
	git commit -m "$(msg)"

push:
	git push -u

update:
	git pull

.PHONY:	all clean fclean re header
